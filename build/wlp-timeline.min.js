!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define("wlp-timeline",["exports"],e):e(t.wlp_timeline={})}(this,function(t){"use strict";function e(){function t(t,e){for(var n=[],r=new Date(t.getTime());e>=r;r.setDate(r.getDate()+1))n.push({startTime:new Date(r.getFullYear(),r.getMonth(),r.getDate(),18,0,0),endTime:new Date(r.getFullYear(),r.getMonth(),r.getDate()+1,6,0,0)});return n}return{nighttimeEvents:t}}function n(t,e,n,r,a,i,o,s){return d3.time.format.multi([[t,function(t){return t.getMilliseconds()}],[e,function(t){return t.getSeconds()}],[n,function(t){return t.getMinutes()}],[r,function(t){return t.getHours()}],[a,function(t){return t.getDay()&&1!=t.getDate()}],[i,function(t){return 1!=t.getDate()}],[o,function(t){return t.getMonth()}],[s,function(){return!0}]])}function r(t,e,n,r,a){return d3.svg.axis().scale(t).tickFormat(e).orient(n).tickSize(r).tickPadding(a)}function a(t,e){A=d3.time.scale().domain([t,e]).range([0,h]);var a=n(".%L",":%S","%_I:%M","%_I %p","%b %-d","%b %-d","%b","%Y"),i=n(" "," "," "," ","%a","%a","%a"," ");k=r(A,a,"bottom",-B,6),T=r(A,i,"bottom",-B,18),D=r(A,"","bottom",-B,0).ticks(d3.time.days,1),M=r(A,"","bottom",-B,0).ticks(d3.time.weeks,1),z=r(A,"","bottom",0,0).ticks(d3.time.years,1)}function i(){var t=A.invert(0),e=A.invert(h);return(e.getTime()-t.getTime())/1e3/3600/24}function o(t,e,n){n>0&&i()>n?b.select(t).call(z):b.select(t).call(e)}function s(){d(),S&&g(),o(".x.axisMain",k,0),o(".x.axis-day-names",T,60),o(".x.axis-days",D,60),o(".x.axis-weeks",M,60)}function c(t,e,n){t.append("g").attr("class",e).attr("transform","translate(0,"+n+")")}function l(t,e){h=e-j.left-j.right;var n=new Date("Jan 1, 2016"),r=new Date;a(n,r),E=d3.behavior.zoom().x(A).scaleExtent([-3e3,3e3]).on("zoom",function(){s()});var i=20;d3.select(t).style("font-family","Avenir").style("font-size","10px").style("top",i+"px").style("bottom",i+"px").style("left",i+"px").style("right",i+"px").style("position","absolute"),v=d3.select(t).append("svg").attr("width",h+j.left+j.right).attr("height",B+j.top/2+j.bottom),b=v.append("g").attr("pointer-events","none").attr("transform","translate("+j.left+","+j.top/2+")"),c(b,"x axisMain",B),c(b,"x axis-day-names",B),c(b,"x axis-days",B),c(b,"x axis-weeks",B),y=v.append("svg").attr("vector-effect","non-scaling-stroke").attr("width",h).attr("height",B).attr("x",j.left).attr("y",j.top/2).attr("viewBox","0 0 "+h+" "+B).call(E),Y=I.nighttimeEvents(n,r),_=y.append("g"),s(),y.append("rect").attr("fill","white").attr("fill-opacity",0).attr("width",h).attr("height",B).attr("class","innertimelinebackground"),w=v.append("g").attr("pointer-events","none").attr("transform","translate("+j.left+","+j.top/2+")"),w.append("rect").attr("fill","white").attr("fill-opacity",0).attr("width",h).attr("height",B).attr("stroke","#eee").attr("stroke-width",3).attr("class","outertimelinebackground")}function u(t){return t.attr("height",B).attr("class","nightrect")}function f(t){t.attr("y",0).attr("x",function(t){return A(t.startTime)}).attr("width",function(t){return A(t.endTime)-A(t.startTime)})}function d(){var t;t=i()>14?[]:Y;var e=_.selectAll("rect.nightrect").data(t);u(e.enter().append("rect")),f(e),e.exit().remove()}function p(t){return t.attr("r",5).attr("fill","#555")}function m(t){t.attr("cy",B/2).attr("cx",function(t){return A(t)})}function g(){var t=F.selectAll("circle").data(S);p(t.enter().append("circle")),m(t),t.exit().remove()}function x(t){S=t,F=y.append("g"),g()}var h,v,y,w,b,k,D,M,T,z,A,E,F,S,Y,_,I=e(),j={top:20,right:20,bottom:30,left:20},B=70-j.top-j.bottom,H="0.0.1";t.version=H,t.drawTimeline=l,t.addData=x,t.viewModel=e});